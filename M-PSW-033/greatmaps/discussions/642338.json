[
  {
    "Id": "1437268",
    "ThreadId": "642338",
    "Html": "Hi,\r<br />\n<br />\nI am in need of minor help/push in the right direction.\r<br />\n<br />\nTrying to incorporate the custom wms.\r<br />\n<a href=\"https://appln.transport.nsw.gov.au/mapservices/proxy/Common/Cache_Map/MapServer/WMSServer?service=WMS&amp;request=GetCapabilities\" rel=\"nofollow\">https://appln.transport.nsw.gov.au/mapservices/proxy/Common/Cache_Map/MapServer/WMSServer?service=WMS&request=GetCapabilities</a>\r<br />\n<br />\nThe tiles end up misaligned and cant figure out where the fix should be implemented.\r<br />\n<br />\nSo far i have;<br />\n<pre><code> public class TmcWms : GMapProvider\n    {\n        private const string UrlFormat = &quot;https://appln.transport.nsw.gov.au/mapservices/proxy/Common/Cache_Map/MapServer/WMSServer?service=WMS&amp;request=GetMap&amp;version=1.3.0&amp;crs=EPSG:3308&amp;format=png&amp;bbox={0},{1},{2},{3}&amp;width={4}&amp;height={5}&amp;Layers=1,2&amp;styles=&quot;;\n        //private const string UrlFormat = &quot;https://appln.transport.nsw.gov.au/mapservices/proxy/Common/Cache_Map/MapServer/WMSServer?service=WMS&amp;request=GetMap&amp;version=1.3.0&amp;crs=CRS:84&amp;format=png&amp;bbox={0},{1},{2},{3}&amp;width={4}&amp;height={5}&amp;Layers=1,2&amp;styles=&quot;;\n        public static readonly TmcWms Instance = new TmcWms();\n        private readonly Guid _Id = new Guid(&quot;{467DB08D-4B5F-45CC-8E6C-7AA47E9CD438}&quot;);\n        private const string _Name = &quot;TMCWMS&quot;;\n        private GMapProvider[] _overlays;\n\n        public override Guid Id\n        {\n            get\n            {\n                return this._Id;\n            }\n        }\n\n        public override string Name\n        {\n            get\n            {\n                return _Name;\n            }\n        }\n\n        public override GMapProvider[] Overlays\n        {\n            get\n            {\n                return _overlays ?? (_overlays = new[]\n                {\n                    (GMapProvider) this\n                });\n            }\n        }\n\n        public override PureProjection Projection\n        {\n            get\n            {\n                \n                return (PureProjection)MercatorProjection.Instance;\n\n            }\n        }\n\n        static TmcWms()\n        {\n        }\n\n        private TmcWms()\n        {\n            \n        }\n\n        public override PureImage GetTileImage(GPoint pos, int zoom)\n        {\n            return this.GetTileImageUsingHttp(this.MakeTileImageUrl(pos, zoom, GMapProvider.LanguageStr));\n        }\n\n        private string MakeTileImageUrl(GPoint pos, int zoom, string language)\n        {\n            GPoint p1 = this.Projection.FromTileXYToPixel(pos);\n            GPoint p2 = p1;\n\n            p1.Offset(0L, this.Projection.TileSize.Height);\n            PointLatLng pointLatLng1 = this.Projection.FromPixelToLatLng(p1, zoom);\n\n            p2.Offset(this.Projection.TileSize.Width, 0L);\n            PointLatLng pointLatLng2 = this.Projection.FromPixelToLatLng(p2, zoom);\n\n            string s = string.Format(CultureInfo.InvariantCulture, UrlFormat,\n                (object) pointLatLng1.Lng, (object) pointLatLng1.Lat, (object) pointLatLng2.Lng,\n                (object) pointLatLng2.Lat, (object)Projection.TileSize.Width, (object)Projection.TileSize.Height);\n            Console.WriteLine(s);\n            return s;\n        }\n    }</code></pre>\n\nAnd the result; (tiles are misaligned)\r<br />\n<br />\n<img src=\"https://dl.dropboxusercontent.com/u/48649931/WmsMisalign.png\" alt=\"Image\" /><br />\n",
    "PostedDate": "2015-08-04T17:37:02.153-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  },
  {
    "Id": "1437269",
    "ThreadId": "642338",
    "Html": "NOTE: WMS Only works for Australia/NSW.<br />\n",
    "PostedDate": "2015-08-04T17:37:49.967-07:00",
    "UserRole": null,
    "MarkedAsAnswerDate": null
  }
]